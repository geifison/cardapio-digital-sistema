<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>POS - Card√°pio Digital</title>
  <link rel="stylesheet" href="assets/css/style.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    body { background: #fff; }
    .hero { display: none !important; }
    .header .logo h1 { font-size: 18px; }
  </style>
  <script>
    // Garante o par√¢metro pos=1 na URL para o app.js reconhecer o modo POS
    (function ensurePOSParam() {
      try {
        var url = new URL(window.location.href);
        if (url.searchParams.get('pos') !== '1') {
          url.searchParams.set('pos', '1');
          window.history.replaceState(null, '', url.toString());
        }
      } catch (_) {}
    })();
  </script>
  <script>
    // Permite receber 'mode' da janela abridora via hash ou query; j√° ser√° passado na URL pelo admin
  </script>
</head>
<body>
  <!-- Reusa exatamente a mesma estrutura do index.html -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <i class="fas fa-cash-register"></i>
          <h1>POS - Balc√£o</h1>
        </div>
        <div class="cart-toggle" onclick="toggleCart()">
          <i class="fas fa-shopping-cart"></i>
          <span class="cart-count" id="cartCount">0</span>
        </div>
      </div>
    </div>
  </header>

  <nav class="categories-nav">
    <div class="container">
      <div class="categories-list" id="categoriesList"></div>
    </div>
  </nav>

  <main class="main-content">
    <div class="container">
      <!-- A√ß√µes r√°pidas do POS -->
      <div style="display:flex; justify-content:flex-end; align-items:center; gap:12px; margin:12px 0;">
        <button type="button" class="checkout-btn" onclick="openPizzaBuilder()" title="Monte sua pizza">
          <i class="fas fa-pizza-slice"></i> Monte sua pizza
        </button>
      </div>
      <div class="content-wrapper">
        <section class="products-section">
          <div class="products-grid" id="productsGrid"></div>
        </section>
      </div>
    </div>
  </main>

  <div class="cart-sidebar" id="cartSidebar">
    <div class="cart-header">
      <h3><i class="fas fa-shopping-cart"></i> Pedido do Balc√£o</h3>
      <button class="close-cart" onclick="toggleCart()"><i class="fas fa-times"></i></button>
    </div>
    <div class="cart-content">
      <div class="cart-items" id="cartItems"></div>
      <div class="cart-empty" id="cartEmpty">
        <i class="fas fa-shopping-cart"></i>
        <p>Seu carrinho est√° vazio</p>
        <small>Adicione alguns itens</small>
      </div>
    </div>
    <div class="cart-footer" id="cartFooter" style="display: none;">
      <div class="cart-summary">
        <div class="summary-row"><span>Subtotal:</span><span id="cartSubtotal">R$ 0,00</span></div>
        <div class="summary-row"><span>Taxa de entrega:</span><span id="deliveryFee">R$ 5,00</span></div>
        <div class="summary-row total"><span>Total:</span><span id="cartTotal">R$ 0,00</span></div>
      </div>
      <button class="checkout-btn" onclick="proceedToCheckout()"><i class="fas fa-credit-card"></i> Finalizar Pedido</button>
    </div>
  </div>

  <!-- Reusa os mesmos modais do checkout/sucesso do index -->
  <div class="modal-overlay" id="checkoutModal">
    <div class="modal">
      <div class="modal-header">
        <h3><i class="fas fa-clipboard-list"></i> Finalizar Pedido</h3>
        <button class="close-modal" onclick="closeCheckoutModal()"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-content">
        <form id="checkoutForm">
          <div class="form-section">
            <h4><i class="fas fa-receipt"></i> Tipo de Pedido</h4>
            <div class="payment-options order-type-options">
              <label class="payment-option"><input type="radio" name="orderType" value="retirada"><span class="payment-label"><i class="fas fa-bag-shopping"></i> Retirada</span></label>
              <label class="payment-option"><input type="radio" name="orderType" value="delivery"><span class="payment-label"><i class="fas fa-truck"></i> Delivery</span></label>
              <label class="payment-option" data-pos-only="true" id="orderTypeBalcaoWrapper"><input type="radio" name="orderType" value="balcao" checked><span class="payment-label"><i class="fas fa-store"></i> Balc√£o</span></label>
            </div>
          </div>
          <div class="form-section">
            <h4><i class="fas fa-user"></i> Dados Pessoais</h4>
            <div class="form-group"><label for="customerName">Nome/Identifica√ß√£o *</label><input type="text" id="customerName" name="customerName" required></div>
            <div class="form-group"><label for="customerPhone">Telefone *</label><input type="tel" id="customerPhone" name="customerPhone" placeholder="(XX) XXXXX-XXXX" maxlength="15" required></div>
          </div>
          <div class="form-section" id="deliveryAddressSection">
            <h4><i class="fas fa-map-marker-alt"></i> Endere√ßo para Entrega</h4>
            <div class="form-group"><label for="addressStreet">Rua *</label><input type="text" id="addressStreet" name="addressStreet"></div>
            <div class="form-group"><label for="addressNumber">N√∫mero *</label><input type="text" id="addressNumber" name="addressNumber"></div>
            <div class="form-group"><label for="customerNeighborhood">Bairro *</label><input type="text" id="customerNeighborhood" name="customerNeighborhood"></div>
            <div class="form-group"><label for="addressCity">Cidade *</label><input type="text" id="addressCity" name="addressCity"></div>
            <div class="form-group"><label for="addressZip">CEP *</label><input type="text" id="addressZip" name="addressZip" placeholder="00000-000" maxlength="9"></div>
            <div class="form-group"><label for="customerReference">Refer√™ncia *</label><input type="text" id="customerReference" name="customerReference"></div>
            <div class="form-group"><label for="addressComplement">Complemento (opcional)</label><input type="text" id="addressComplement" name="addressComplement"></div>
          </div>
          <div class="form-section">
            <h4><i class="fas fa-credit-card"></i> Pagamento</h4>
            <div class="payment-options">
              <label class="payment-option"><input type="radio" name="paymentMethod" value="dinheiro" checked><span class="payment-label"><i class="fas fa-money-bill-wave"></i> Dinheiro</span></label>
              <label class="payment-option"><input type="radio" name="paymentMethod" value="cartao"><span class="payment-label"><i class="fas fa-credit-card"></i> Cart√£o</span></label>
              <label class="payment-option"><input type="radio" name="paymentMethod" value="pix"><span class="payment-label"><i class="fas fa-qrcode"></i> PIX</span></label>
            </div>
            <div class="money-section" id="moneySection">
              <div class="form-group"><label for="paymentValue">Valor para troco</label><input type="number" id="paymentValue" name="paymentValue" step="0.01" min="0"><small>Deixe em branco se n√£o precisar</small></div>
              <div class="change-display" id="changeDisplay" style="display:none;"><span>Troco: <strong id="changeAmount">R$ 0,00</strong></span></div>
            </div>
          </div>
          <div class="form-section">
            <h4><i class="fas fa-sticky-note"></i> Observa√ß√µes</h4>
            <div class="form-group"><textarea id="orderNotes" name="orderNotes" rows="2" placeholder="Observa√ß√µes gerais"></textarea></div>
          </div>
          <div class="order-summary">
            <h4>Resumo do Pedido</h4>
            <div id="checkoutItems"></div>
            <div class="summary-totals">
              <div class="summary-row"><span>Subtotal:</span><span id="checkoutSubtotal">R$ 0,00</span></div>
              <div class="summary-row"><span>Taxa de entrega:</span><span id="checkoutDeliveryFee">R$ 5,00</span></div>
              <div class="summary-row total"><span>Total:</span><span id="checkoutTotal">R$ 0,00</span></div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-secondary" onclick="closeCheckoutModal()">Voltar</button>
        <button type="button" class="btn-primary" onclick="submitOrder()"><i class="fas fa-check"></i> Confirmar Pedido</button>
      </div>
    </div>
  </div>

  <div class="loading-overlay" id="loadingOverlay"><div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i><p>Processando seu pedido...</p></div></div>
  <div class="modal-overlay" id="successModal"><div class="modal success-modal"><div class="modal-content"><div class="success-icon"><i class="fas fa-check-circle"></i></div><h3>Pedido Realizado com Sucesso!</h3><p>Pedido enviado.</p><div class="order-info"><p><strong>N√∫mero:</strong> <span id="orderNumber"></span></p><p><strong>Tempo estimado:</strong> <span id="estimatedTime">30 minutos</span></p></div><button class="btn-primary" style="background:#25D366;border-color:#25D366;" onclick="openWhatsAppWithOrder()"><i class="fab fa-whatsapp"></i> Enviar e acompanhar no WhatsApp</button><button class="btn-primary" onclick="closeSuccessModal()"><i class="fas fa-home"></i> Novo Pedido</button></div></div></div>

  <!-- Pizza Builder Modal (copiado de index.html) -->
  <div class="modal-overlay" id="pizzaBuilderModal">
    <div class="modal pizza-builder-modal">
      <div class="modal-content pizza-builder-content">
        <div class="modal-header">
          <h3 id="pizzaBuilderTitle">üçï Monte Sua Pizza</h3>
          <button class="close-modal" onclick="closePizzaBuilder()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="pizza-progress">
            <div class="progress-step active" data-step="1">
              <span class="step-number">1</span>
              <span class="step-label">Tamanho</span>
            </div>
            <div class="progress-step" data-step="2">
              <span class="step-number">2</span>
              <span class="step-label">Sabores</span>
            </div>
            <div class="progress-step" data-step="3">
              <span class="step-number">3</span>
              <span class="step-label">Adicionais</span>
            </div>
            <div class="progress-step" data-step="4">
              <span class="step-number">4</span>
              <span class="step-label">Resumo</span>
            </div>
          </div>

          <!-- Step 1: Tamanho -->
          <div class="pizza-step active" id="step-1">
            <div class="step-header">
              <h4>Escolha o Tamanho da Sua Pizza</h4>
              <p>O tamanho define quantos sabores voc√™ pode escolher</p>
            </div>
            <div class="sizes-grid" id="sizesGrid"></div>
            <div class="step-actions">
              <button class="btn btn-primary" onclick="nextPizzaStep()" disabled id="nextStep1">
                Continuar <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>

          <!-- Step 2: Sabores -->
          <div class="pizza-step" id="step-2">
            <div class="step-header">
              <h4>Escolha os Sabores</h4>
              <p id="flavorsInfo">Selecione at√© <span id="maxFlavors">1</span> sabor</p>
              <div class="parts-info" style="margin-top:8px;font-size:13px;color:#666;">
                Partes usadas: <strong><span id="usedPartsCounter">0</span></strong> / <strong><span id="totalPartsCounter">0</span></strong>
              </div>
            </div>
            <div class="flavors-container">
              <div class="pizza-visual">
                <div class="pizza-circle" id="pizzaCircle"></div>
                <div class="pizza-info">
                  <h5 id="selectedSizeName">Tamanho</h5>
                  <p id="selectedSizeInfo">Informa√ß√µes do tamanho</p>
                </div>
              </div>
              <div class="flavors-selection">
                <div class="flavor-categories">
                  <button class="category-btn active" data-category="all">Todos</button>
                  <button class="category-btn" data-category="tradicional">Tradicionais</button>
                  <button class="category-btn" data-category="especial">Especiais</button>
                  <button class="category-btn" data-category="doce">Doces</button>
                </div>
                <div class="flavors-grid" id="flavorsGrid"></div>
              </div>
            </div>
            <div class="step-actions">
              <button class="btn btn-secondary" onclick="previousPizzaStep()"><i class="fas fa-arrow-left"></i> Voltar</button>
              <button class="btn btn-primary" onclick="nextPizzaStep()" disabled id="nextStep2">Continuar <i class="fas fa-arrow-right"></i></button>
            </div>
          </div>

          <!-- Step 3: Adicionais -->
          <div class="pizza-step" id="step-3">
            <div class="step-header">
              <h4>Adicionais (Opcional)</h4>
              <p>Adicione ingredientes extras √† sua pizza</p>
            </div>
            <div class="extras-container">
              <div class="extras-categories">
                <button class="category-btn active" data-category="all">Todos</button>
                <button class="category-btn" data-category="queijo">Queijos</button>
                <button class="category-btn" data-category="carne">Carnes</button>
                <button class="category-btn" data-category="vegetal">Vegetais</button>
              </div>
              <div class="extras-grid" id="extrasGrid"></div>
            </div>
            <div class="step-actions">
              <button class="btn btn-secondary" onclick="previousPizzaStep()"><i class="fas fa-arrow-left"></i> Voltar</button>
              <button class="btn btn-primary" onclick="nextPizzaStep()" id="nextStep3">Continuar <i class="fas fa-arrow-right"></i></button>
            </div>
          </div>

          <!-- Step 4: Resumo -->
          <div class="pizza-step" id="step-4">
            <div class="step-header">
              <h4>Resumo da Sua Pizza</h4>
              <p>Confirme os detalhes antes de adicionar ao carrinho</p>
            </div>
            <div class="pizza-summary">
              <div class="summary-visual">
                <div class="pizza-preview" id="pizzaPreview"></div>
              </div>
              <div class="summary-details">
                <div class="summary-item">
                  <h5>Tamanho</h5>
                  <p id="summarySize">-</p>
                </div>
                <div class="summary-item">
                  <h5>Sabores</h5>
                  <p id="summaryFlavors">-</p>
                </div>
                <div class="summary-item" id="summaryExtrasContainer" style="display: none;">
                  <h5>Adicionais</h5>
                  <p id="summaryExtras">-</p>
                </div>
                <div class="summary-price">
                  <h5>Pre√ßo Total</h5>
                  <p class="price" id="summaryPrice">R$ 0,00</p>
                </div>
                <div class="summary-item" style="margin-top:16px;">
                  <h5>Observa√ß√µes (Opcional)</h5>
                  <textarea id="pizzaObservations" rows="3" placeholder="Ex: Sem cebola, bem passada, etc..." style="width:100%;padding:10px;border:1px solid #e5e7eb;border-radius:8px;font-family:inherit;"></textarea>
                </div>
                <div class="summary-item" style="margin-top:12px;">
                  <h5>Prefer√™ncias de Preparo</h5>
                  <div class="prefs-grid" style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px;margin-top:8px;">
                    <label style="display:flex;align-items:center;gap:8px;font-size:14px;"><input type="checkbox" class="pizza-pref" value="Bem passada"> Bem passada</label>
                    <label style="display:flex;align-items:center;gap:8px;font-size:14px;"><input type="checkbox" class="pizza-pref" value="Queijo extra"> Queijo extra</label>
                    <label style="display:flex;align-items:center;gap:8px;font-size:14px;"><input type="checkbox" class="pizza-pref" value="Borda crocante"> Borda crocante</label>
                    <label style="display:flex;align-items:center;gap:8px;font-size:14px;"><input type="checkbox" class="pizza-pref" value="Sem cebola"> Sem cebola</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="step-actions">
              <button class="btn btn-secondary" onclick="previousPizzaStep()"><i class="fas fa-arrow-left"></i> Voltar</button>
              <button class="btn btn-success" onclick="addPizzaToCart()" id="addToCartBtn">
                <i class="fas fa-shopping-cart"></i> Adicionar ao Carrinho
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>
  <script src="assets/js/app.js"></script>
</body>
</html>


