<!-- Order Detail Modal -->
<div class="modal-overlay" id="orderDetailModal">
    <div class="modal large-modal">
        <div class="modal-content p-0" id="orderDetailContent">
            <!-- ConteÃºdo serÃ¡ carregado dinamicamente com o novo layout -->
        </div>
    </div>
</div>

<!-- Add/Edit Product Modal -->
<div class="modal-overlay" id="productModal">
    <div class="modal large-modal">
        <div class="modal-header">
            <h3 id="productModalTitle"><i class="fa-solid fa-plus"></i> Novo Produto</h3>
            <button class="close-modal" onclick="closeProductModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <form id="productForm" class="product-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="productName">Nome do Produto *</label>
                        <input type="text" id="productName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="productCategory">Categoria *</label>
                        <select id="productCategory" name="category_id" required>
                            <option value="">Selecione uma categoria</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="productType">Tipo de Produto *</label>
                        <select id="productType" name="product_type" required onchange="toggleProductTypeFields()">
                            <option value="comum">Produto Comum</option>
                            <option value="pizza">Pizza GerenciÃ¡vel</option>
                        </select>
                    </div>
                    <div class="form-group" id="productPriceGroup">
                        <label for="productPrice">PreÃ§o *</label>
                        <input type="number" id="productPrice" name="price" step="0.01" min="0" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="productOrder">Ordem de ExibiÃ§Ã£o</label>
                        <input type="number" id="productOrder" name="display_order" min="0" value="0">
                    </div>
                    <div class="form-group" id="pizzaInfoGroup" style="display: none;">
                        <div class="info-card">
                            <i class="fa-solid fa-circle-info"></i>
                            <p>Para pizzas gerenciÃ¡veis, o preÃ§o serÃ¡ calculado automaticamente baseado nos tamanhos, sabores e adicionais configurados no sistema.</p>
                        </div>
                    </div>
                </div>
                
                <!-- SeÃ§Ã£o de configuraÃ§Ãµes para pizzas -->
                <div id="pizzaConfigSection" style="display: none;">
                    <!-- Tamanhos -->
                    <div class="form-group">
                        <label class="section-label">ðŸ• Tamanhos DisponÃ­veis:</label>
                        <div class="checkbox-group" id="pizzaSizesCheckboxes">
                            <!-- Os checkboxes serÃ£o carregados dinamicamente -->
                        </div>
                    </div>
                    
                    <!-- Sabores -->
                    <div class="form-group">
                        <label class="section-label">ðŸ• Sabores DisponÃ­veis:</label>
                        <div class="pizza-config-tabs">
                            <button type="button" class="config-tab active" onclick="showFlavorCategory('all')">Todos</button>
                            <button type="button" class="config-tab" onclick="showFlavorCategory('tradicional')">Tradicionais</button>
                            <button type="button" class="config-tab" onclick="showFlavorCategory('especial')">Especiais</button>
                            <button type="button" class="config-tab" onclick="showFlavorCategory('doce')">Doces</button>
                        </div>
                        <div class="checkbox-group" id="pizzaFlavorsCheckboxes">
                            <!-- Os checkboxes serÃ£o carregados dinamicamente -->
                        </div>
                    </div>
                    
                    <!-- Bordas -->
                    <div class="form-group">
                        <label class="section-label">ðŸ• Bordas DisponÃ­veis:</label>
                        <div class="checkbox-group" id="pizzaBordersCheckboxes">
                            <!-- Os checkboxes serÃ£o carregados dinamicamente -->
                        </div>
                    </div>
                    
                    <!-- Adicionais -->
                    <div class="form-group">
                        <label class="section-label">ðŸ• Adicionais DisponÃ­veis:</label>
                        <div class="pizza-config-tabs">
                            <button type="button" class="config-tab active" onclick="showExtraCategory('all')">Todos</button>
                            <button type="button" class="config-tab" onclick="showExtraCategory('Queijos')">Queijos</button>
                            <button type="button" class="config-tab" onclick="showExtraCategory('Carnes')">Carnes</button>
                            <button type="button" class="config-tab" onclick="showExtraCategory('Vegetais')">Vegetais</button>
                            <button type="button" class="config-tab" onclick="showExtraCategory('Molhos')">Molhos</button>
                        </div>
                        <div class="checkbox-group" id="pizzaExtrasCheckboxes">
                            <!-- Os checkboxes serÃ£o carregados dinamicamente -->
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="productDescription">DescriÃ§Ã£o</label>
                    <textarea id="productDescription" name="description" rows="3"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="productImageUpload">Imagem do Produto</label>
                        <input type="file" id="productImageUpload" name="image_upload" accept="image/*" onchange="previewImage(event)">
                        <input type="hidden" id="productImage" name="image_url">
                        <div id="imagePreview" class="image-preview" style="display: none;">
                            <img id="preview" src="#" alt="PrÃ©-visualizaÃ§Ã£o da imagem">
                            <button type="button" class="remove-image" onclick="removeImage()">Remover Imagem</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="productPrepTime">Tempo de Preparo (min)</label>
                        <input type="number" id="productPrepTime" name="preparation_time" min="0" value="0">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="productActive" name="active" checked>
                        <span class="checkmark"></span>
                        Produto Ativo (disponÃ­vel no cardÃ¡pio)
                    </label>
                </div>
                
                <div class="form-group">
                    <label class="section-label">CaracterÃ­sticas Especiais:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="productVegetarian" name="is_vegetarian">
                            <span class="checkmark"></span>
                            Vegetariano
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="productVegan" name="is_vegan">
                            <span class="checkmark"></span>
                            Vegano
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="productGlutenFree" name="is_gluten_free">
                            <span class="checkmark"></span>
                            Sem GlÃºten
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="productSpicy" name="is_spicy">
                            <span class="checkmark"></span>
                            Picante
                        </label>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeProductModal()">
                <i class="fa-solid fa-times"></i>
                Cancelar
            </button>
            <button class="btn-primary" onclick="saveProduct()">
                <i class="fa-solid fa-floppy-disk"></i>
                Salvar Produto
            </button>
        </div>
    </div>
</div>

<!-- Delete Product Confirmation Modal -->
<div class="modal-overlay" id="deleteProductModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-triangle-exclamation"></i> Confirmar ExclusÃ£o</h3>
            <button class="close-modal" onclick="closeDeleteProductModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <p>Tem certeza que deseja excluir o produto <strong id="deleteProductName"></strong>?</p>
            <p class="warning-text">Esta aÃ§Ã£o nÃ£o pode ser desfeita!</p>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeDeleteProductModal()">
                <i class="fa-solid fa-times"></i>
                Cancelar
            </button>
            <button class="btn-danger" onclick="confirmDeleteProduct()">
                <i class="fa-solid fa-trash"></i>
                Excluir
            </button>
        </div>
    </div>
</div>

<!-- Print Modal -->
<div class="modal-overlay" id="printModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-print"></i> Imprimir Comanda</h3>
            <button class="close-modal" onclick="closePrintModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <div class="print-options">
                <button class="print-btn kitchen-print" onclick="printKitchenOrder()">
                    <i class="fa-solid fa-fire"></i>
                    Comanda da Cozinha
                </button>
                <button class="print-btn customer-print" onclick="printCustomerOrder()">
                    <i class="fa-solid fa-user"></i>
                    Comanda do Cliente
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Pizza Size Modal -->
<div class="modal-overlay" id="pizzaSizeModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-ruler"></i> <span id="pizzaSizeModalTitle">Novo Tamanho</span></h3>
            <button class="close-modal" onclick="closePizzaSizeModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <form id="pizzaSizeForm">
                <div class="form-group">
                    <label for="sizeName">Nome do Tamanho *</label>
                    <input type="text" id="sizeName" name="name" required placeholder="Ex: MÃ©dia, Grande, FamÃ­lia">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="sizeSlices">Quantidade de Fatias *</label>
                        <input type="number" id="sizeSlices" name="slices" required min="4" max="16" placeholder="6">
                    </div>
                    <div class="form-group">
                        <label for="sizeMaxFlavors">MÃ¡ximo de Sabores *</label>
                        <input type="number" id="sizeMaxFlavors" name="max_flavors" required min="1" max="5" placeholder="2">
                    </div>
                </div>
                <div class="form-group">
                    <label for="sizePrice">PreÃ§o Base (R$) *</label>
                    <input type="number" id="sizePrice" name="price" required min="0" step="0.01" placeholder="25.00">
                </div>
                <div class="form-group">
                    <label for="sizeDescription">DescriÃ§Ã£o</label>
                    <textarea id="sizeDescription" name="description" rows="3" placeholder="DescriÃ§Ã£o opcional do tamanho"></textarea>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="sizeActive" name="active" checked>
                        <span class="checkmark"></span>
                        Ativo
                    </label>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closePizzaSizeModal()">
                <i class="fa-solid fa-times"></i>
                Cancelar
            </button>
            <button class="btn-primary" onclick="savePizzaSize()">
                <i class="fa-solid fa-floppy-disk"></i>
                Salvar Tamanho
            </button>
        </div>
    </div>
</div>

<!-- Pizza Flavor Modal -->
<div class="modal-overlay" id="pizzaFlavorModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-pizza-slice"></i> <span id="pizzaFlavorModalTitle">Novo Sabor</span></h3>
            <button class="close-modal" onclick="closePizzaFlavorModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <form id="pizzaFlavorForm">
                <div class="form-group">
                    <label for="flavorName">Nome do Sabor *</label>
                    <input type="text" id="flavorName" name="name" required placeholder="Ex: Margherita, Pepperoni">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="flavorCategory">Categoria *</label>
                        <select id="flavorCategory" name="category" required>
                            <option value="">Selecione uma categoria</option>
                            <option value="Tradicional">Tradicional</option>
                            <option value="Especial">Especial</option>
                            <option value="Vegetariana">Vegetariana</option>
                            <option value="Vegana">Vegana</option>
                            <option value="Doce">Doce</option>
                        </select>
                    </div>
                     <div class="form-group">
                         <label for="flavorCategoryValue">PreÃ§o da Categoria (R$)</label>
                         <input type="text" id="flavorCategoryValue" name="category_value" inputmode="numeric" placeholder="0,00" autocomplete="off">
                         <small>Use vÃ­rgula para centavos. Ex: 1.234,56</small>
                     </div>
                </div>
                <div class="form-group">
                    <label for="flavorDescription">DescriÃ§Ã£o</label>
                    <textarea id="flavorDescription" name="description" rows="3" placeholder="DescriÃ§Ã£o dos ingredientes"></textarea>
                </div>
                <div class="form-group">
                    <label for="flavorIngredients">Ingredientes</label>
                    <textarea id="flavorIngredients" name="ingredients" rows="3" placeholder="Lista de ingredientes (separados por vÃ­rgula)"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="flavorVegan" name="is_vegan">
                            <span class="checkmark"></span>
                            Vegano
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="flavorGlutenFree" name="is_gluten_free">
                            <span class="checkmark"></span>
                            Sem GlÃºten
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="flavorSpicy" name="is_spicy">
                            <span class="checkmark"></span>
                            Picante
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="flavorActive" name="active" checked>
                        <span class="checkmark"></span>
                        Ativo
                    </label>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closePizzaFlavorModal()">
                <i class="fa-solid fa-times"></i>
                Cancelar
            </button>
            <button class="btn-primary" onclick="savePizzaFlavor()">
                <i class="fa-solid fa-floppy-disk"></i>
                Salvar Sabor
            </button>
        </div>
    </div>
</div>

<!-- Pizza Extra Modal -->
<div class="modal-overlay" id="pizzaExtraModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-circle-plus"></i> <span id="pizzaExtraModalTitle">Novo Adicional</span></h3>
            <button class="close-modal" onclick="closePizzaExtraModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <form id="pizzaExtraForm">
                <div class="form-group">
                    <label for="extraName">Nome do Adicional *</label>
                    <input type="text" id="extraName" name="name" required placeholder="Ex: Queijo Extra, Bacon">
                </div>
                <div class="form-group">
                    <label for="extraCategory">Categoria *</label>
                    <select id="extraCategory" name="category" required>
                        <option value="">Selecione uma categoria</option>
                        <option value="Queijos">Queijos</option>
                        <option value="Carnes">Carnes</option>
                        <option value="Vegetais">Vegetais</option>
                        <option value="Molhos">Molhos</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="extraPrice">PreÃ§o *</label>
                        <input type="number" id="extraPrice" name="price" required step="0.01" min="0" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label for="extraDisplayOrder">Ordem de ExibiÃ§Ã£o</label>
                        <input type="number" id="extraDisplayOrder" name="display_order" min="0" placeholder="0">
                    </div>
                </div>
                <div class="form-group">
                    <label for="extraDescription">DescriÃ§Ã£o</label>
                    <textarea id="extraDescription" name="description" rows="3" placeholder="DescriÃ§Ã£o do adicional"></textarea>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="extraActive" name="active" checked>
                        <span class="checkmark"></span>
                        Ativo
                    </label>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closePizzaExtraModal()">
                <i class="fa-solid fa-times"></i>
                Cancelar
            </button>
            <button class="btn-primary" onclick="savePizzaExtra()">
                <i class="fa-solid fa-floppy-disk"></i>
                Salvar Adicional
            </button>
        </div>
    </div>
</div>

<!-- Delete Pizza Item Modal -->
<div class="modal-overlay" id="deletePizzaItemModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-triangle-exclamation"></i> Confirmar ExclusÃ£o</h3>
            <button class="close-modal" onclick="closeDeletePizzaItemModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <p>Tem certeza que deseja excluir <strong id="deletePizzaItemName"></strong>?</p>
            <p class="warning-text">Esta aÃ§Ã£o nÃ£o pode ser desfeita!</p>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeDeletePizzaItemModal()">
                <i class="fa-solid fa-times"></i>
                Cancelar
            </button>
            <button class="btn-danger" onclick="confirmDeletePizzaItem()">
                <i class="fa-solid fa-trash"></i>
                Excluir
            </button>
        </div>
    </div>
</div>

<!-- Category Modal -->
<div class="modal-overlay" id="categoryModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-tags"></i> <span id="categoryModalTitle">Nova Categoria</span></h3>
            <button class="close-modal" onclick="closeCategoryModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <form id="categoryForm">
                <div class="form-group">
                    <label for="categoryName">Nome da Categoria *</label>
                    <input type="text" id="categoryName" name="name" required placeholder="Ex: Lanches, Bebidas, Sobremesas">
                </div>
                <div class="form-group">
                    <label for="categoryDescription">DescriÃ§Ã£o</label>
                    <textarea id="categoryDescription" name="description" rows="3" placeholder="DescriÃ§Ã£o opcional da categoria"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="categoryOrder">Ordem de ExibiÃ§Ã£o</label>
                        <input type="number" id="categoryOrder" name="display_order" min="0" value="0" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="categoryActive" name="active" checked>
                            <span class="checkmark"></span>
                            Categoria Ativa
                        </label>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeCategoryModal()">
                <i class="fa-solid fa-times"></i>
                Cancelar
            </button>
            <button class="btn-primary" onclick="saveCategory()">
                <i class="fa-solid fa-floppy-disk"></i>
                Salvar Categoria
            </button>
        </div>
    </div>
</div>

<!-- Delete Category Modal -->
<div class="modal-overlay" id="deleteCategoryModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-triangle-exclamation"></i> Confirmar ExclusÃ£o</h3>
            <button class="close-modal" onclick="closeDeleteCategoryModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <p>Tem certeza que deseja excluir a categoria <strong id="deleteCategoryName"></strong>?</p>
            <p class="warning-text">âš ï¸ Todos os produtos desta categoria precisarÃ£o ser reclassificados!</p>
            <div class="category-products-count" id="categoryProductsCount" style="display: none;">
                <p><strong>Esta categoria possui <span id="productsInCategory">0</span> produto(s) associado(s).</strong></p>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeDeleteCategoryModal()">
                <i class="fa-solid fa-times"></i>
                Cancelar
            </button>
            <button class="btn-danger" onclick="confirmDeleteCategory()">
                <i class="fa-solid fa-trash"></i>
                Excluir
            </button>
        </div>
    </div>
</div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner">
        <i class="fa-solid fa-spinner fa-spin"></i>
        <p>Carregando...</p>
    </div>
</div>

<!-- Cancel Order Modal -->
<div class="modal-overlay" id="cancelOrderModal">
    <div class="modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-ban"></i> Cancelar Pedido</h3>
            <button class="close-modal" onclick="closeCancelOrderModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <div class="form-group">
                <label for="cancelReason">Informe o motivo do cancelamento</label>
                <textarea id="cancelReason" rows="4" placeholder="Ex.: Cliente desistiu, erro no pedido, pagamento nÃ£o confirmado, etc."></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeCancelOrderModal()">
                <i class="fa-solid fa-times"></i>
                Voltar
            </button>
            <button class="btn-danger" onclick="confirmCancelOrder()">
                <i class="fa-solid fa-ban"></i>
                Confirmar Cancelamento
            </button>
        </div>
    </div>
    
</div>

<!-- Audio for notifications -->
<audio id="notificationSound" preload="auto">
    <source src="../order-sound.mp3" type="audio/mpeg">
</audio>

<!-- New Order Modal (POS via Frontend) -->
<div class="modal-overlay" id="newOrderModal">
    <div class="modal large-modal">
        <div class="modal-header">
            <h3><i class="fa-solid fa-plus"></i> Novo Pedido</h3>
            <button class="close-modal" onclick="closeNewOrderModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-content" style="padding:0;">
            <div style="width:100%; height:80vh; background:#f7f7f7; position:relative;">
                <iframe id="posIframe" src="" style="position:absolute; inset:0; width:100%; height:100%; border:0; background:#fff;"></iframe>
            </div>
        </div>
        <div class="modal-footer">
            <small style="flex:1; color:#666;">OperaÃ§Ã£o de balcÃ£o usando o cardÃ¡pio do cliente.</small>
            <button class="btn-secondary" onclick="closeNewOrderModal()">
                <i class="fa-solid fa-times"></i> Fechar
            </button>
        </div>
    </div>
 </div>


